(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-63ed9ffa"],{"65ed":function(e,t,s){"use strict";var a=s("a8da"),i=s.n(a);i.a},7732:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container"},[s("add-button",{on:{add:e.add}}),e._v(" "),s("div",{staticClass:"header"},[s("el-form",{ref:"searchForm",attrs:{model:e.searchForm,inline:!0,size:"medium"}},[s("el-form-item",{attrs:{label:"名称:",prop:"name"}},[s("el-input",{attrs:{maxLength:"11"},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"状态:",prop:"status"}},[s("el-select",{model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[s("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),s("el-option",{attrs:{label:"上架",value:"true"}}),e._v(" "),s("el-option",{attrs:{label:"下架",value:"false"}})],1)],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.fetchData(e.searchForm)}}},[e._v("查询")])],1)],1)],1),e._v(" "),s("xl-table",{ref:"goodsTable",attrs:{index:!0,selection:!0,loading:e.loading,"table-data":e.goodsData,"table-columns":e.columns},on:{"selection-change":e.handleSelectionChange}}),e._v(" "),s("div",{staticClass:"footer"},[s("el-button",{attrs:{type:"success"},on:{click:function(t){return e.changeStatus(!0)}}},[e._v("上架")]),e._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.changeStatus(!1)}}},[e._v("下架")])],1),e._v(" "),s("el-dialog",{attrs:{width:"40%",title:e.isAdd?"新增商品":"编辑商品","close-on-click-modal":!0,visible:e.editVisible},on:{"update:visible":function(t){e.editVisible=t},close:e.close}},[s("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[s("el-form-item",{attrs:{label:"名称：",prop:"name"}},[s("el-input",{attrs:{maxLength:"20"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"宣传图",prop:"img"}},[s("el-upload",{ref:"upload",attrs:{action:"/file/add","on-remove":e.removeImg,"on-success":e.uploadOk,"on-error":e.onError,"file-list":e.fileList,"auto-upload":!0,"list-type":"picture-card",accept:"['.png','.jpg']"}},[s("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),s("el-form-item",{attrs:{label:"库存：",prop:"stores"}},[s("el-input",{attrs:{maxLength:"10"},model:{value:e.form.stores,callback:function(t){e.$set(e.form,"stores",e._n(t))},expression:"form.stores"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"状态：",prop:"status"}},[s("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"上架","inactive-text":"下架"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"价格：",prop:"price"}},[s("el-input",{attrs:{maxLength:"10"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("提交")]),e._v(" "),s("el-button",{on:{click:e.resetForm}},[e._v("重置")])],1)],1)],1)},i=[],r=(s("7f7f"),s("b4e4")),n=s("a417"),o={getGoods:function(e){return Object(n["a"])("/goods/list",e)},updateGoods:function(e){return Object(n["a"])("/goods/update",e)},deleteGoods:function(e){return Object(n["a"])("/goods/delete",e)},changeStatusGoods:function(e){return Object(n["a"])("/goods/changeStatus",e)}},l=s("ed08"),c={name:"GoodsList",components:{AddButton:r["a"]},data:function(){var e=this,t=(this.$createElement,function(t,s,a){0===e.fileList.length?a(new Error("请上传一张图片")):a()});return{goodsData:[],columns:[{label:"名称",prop:"name",align:"left"},{label:"图片",prop:"pic",align:"center",render:function(e,t){var s=t.props.row;return e("div",{class:"table-img"},[e("el-image",{attrs:{src:s.pic,fit:"fit"}})])}},{label:"库存/状态",align:"center",render:function(e,t){var s=t.props.row;return e("div",[e("div",{class:"stores"},[s.stores]),e("el-tag",{attrs:{size:"medium",type:s.status?"success":"danger"}},[s.status?"上架":"下架"])])}},{label:"价格",prop:"price",align:"center"},{label:"销量",prop:"numberSells",align:"center"},{label:"添加/更新时间",align:"center",width:"240",render:function(e,t){var s=t.props.row;return e("div",[e("p",[s.addTime]),e("p",[s.updateTime])])}},{label:"操作",prop:"region",align:"center",render:function(t,s){var a=s.props.row;return t("div",{class:"table-action"},[t("span",{on:{click:function(){return e.update(a)}}},["编 辑"]),t("el-divider",{attrs:{direction:"vertical"}}),t("span",{on:{click:function(){return e.delete(a.id)}}},["删 除"])])}}],loading:!1,isAdd:!1,editVisible:!1,imgUrl:"",form:{name:"",stores:"",status:"",price:"",img:""},searchForm:{name:"",status:""},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{min:4,max:20,message:"长度在 4 到 20 个字符",trigger:"blur"}],stores:[{required:!0,message:"库存不能为空",trigger:"blur"},{type:"number",min:0,message:"不能小于0",trigger:"blur"}],price:[{required:!0,message:"价格不能为空",trigger:"blur"},{type:"number",min:0,message:"不能小于0",trigger:"blur"}],img:[{validator:t,trigger:"blur"}]},fileList:[],selected:[]}},watch:{fileList:function(e){this.hideUpload(0===e.length)}},created:function(){this.fetchData()},methods:{changeStatus:function(e){var t=this;o.changeStatusGoods({ids:this.selected,status:e}).then(function(e){t.$message1000("成功","success"),t.fetchData()})},handleSelectionChange:function(e){this.selected=e.map(function(e){return e.id})},onError:function(){this.$message1000("文件上传出错：网络错误","error")},removeImg:function(){this.fileList=[]},uploadOk:function(e){var t=e.success,s=e.msg,a=e.data;t?(this.$message1000("图片上传成功","success"),this.form.img=a.imgUrl):(this.$message1000(s,"error"),this.fileList=[])},fetchData:function(e){var t=this;this.loading=!0,o.getGoods(e).then(function(e){t.goodsData=e.list}).finally(function(e){t.loading=!1})},add:function(){this.isAdd=!0,this.editVisible=!0},hideUpload:function(e){var t=this;setTimeout(function(){t.$refs.upload.$refs["upload-inner"].$el.style.display=e?"":"none"},0)},update:function(e){this.isAdd=!1,this.form=Object(l["b"])(e),this.fileList=[{name:e.name,url:e.pic}],this.editVisible=!0},delete:function(e){var t=this;this.$confirm("此操作将删除该商品, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.deleteGoods(e).then(function(e){t.$message1000("删除成功","success"),t.fetchData()})})},close:function(){this.fileList=[],this.form={name:"",stores:"",status:"",price:""}},submitForm:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return!1;o.updateGoods(e.form).then(function(t){e.editVisible=!1,e.$message1000("提交成功","success")})})},resetForm:function(){this.$refs.form.resetFields()}}},u=c,d=(s("ae75a"),s("2877")),m=Object(d["a"])(u,a,i,!1,null,"4b2bbf30",null);t["default"]=m.exports},a342:function(e,t,s){},a8da:function(e,t,s){},ae75a:function(e,t,s){"use strict";var a=s("a342"),i=s.n(a);i.a},b4e4:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"add-button",on:{click:e.add}},[s("i",{staticClass:"el-icon-plus"})])},i=[],r={name:"AddButton",methods:{add:function(){this.$emit("add")}}},n=r,o=(s("65ed"),s("2877")),l=Object(o["a"])(n,a,i,!1,null,"f1447e70",null);t["a"]=l.exports}}]);