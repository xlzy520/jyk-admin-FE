(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ec83af3a"],{"65ed":function(e,t,i){"use strict";var a=i("a8da"),n=i.n(a);n.a},"943b":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("add-button",{on:{add:e.add}}),e._v(" "),i("xl-table",{ref:"partnerTable",attrs:{index:!0,loading:e.loading,"table-data":e.partnerData,"table-columns":e.columns}}),e._v(" "),i("el-dialog",{attrs:{width:"40%",title:e.isAdd?"新增合作伙伴":"合作伙伴信息更新","close-on-click-modal":!0,visible:e.editVisible},on:{"update:visible":function(t){e.editVisible=t},close:e.close}},[i("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[i("el-form-item",{attrs:{label:"名称：",prop:"name"}},[i("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"宣传图",prop:"img"}},[i("el-upload",{ref:"upload",attrs:{action:"/partner/"+e.url,"on-preview":e.handlePreview,"on-remove":e.controlHideUpload,"on-success":e.uploadOk,"on-error":e.onError,data:e.form,"on-change":e.controlHideUpload,"file-list":e.fileList,"auto-upload":!1,"list-type":"picture-card",accept:"['.png','.jpg']"}},[i("i",{staticClass:"el-icon-plus"})]),e._v(" "),i("el-dialog",{attrs:{visible:e.imgVisible,"append-to-body":""},on:{"update:visible":function(t){e.imgVisible=t}}},[i("el-image",{attrs:{src:e.dialogImageUrl,alt:"",fit:"fill"}})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"是否展示：",prop:"display"}},[i("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"展示","inactive-text":"隐藏"},model:{value:e.form.display,callback:function(t){e.$set(e.form,"display",t)},expression:"form.display"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("提交")]),e._v(" "),i("el-button",{on:{click:e.resetForm}},[e._v("重置")])],1)],1)],1)},n=[],r=(i("96cf"),i("3b8d")),s=i("b4e4"),l=i("a417"),o={getPartner:function(e){return Object(l["a"])("/partner/list",e)},deletePartner:function(e){return Object(l["a"])("/partner/delete",e)}},c=i("ed08"),d={name:"Partner",components:{AddButton:s["a"]},data:function(){var e=this;this.$createElement;return{partnerData:[],columns:[{label:"名称",prop:"name",align:"center"},{label:"宣传图",prop:"img",align:"center",render:function(e,t){var i=t.props.row;return e("div",{class:"table-img"},[e("el-image",{attrs:{src:i.img,fit:"fit"}})])}},{label:"是否展示",prop:"display",align:"center",render:function(e,t){var i=t.props.row;return e("div",{class:"is-default-icon"},[e("i",{class:"el-icon-"+(i.display?"success":"error")})])}},{label:"添加时间",prop:"addTime",align:"center"},{label:"更新时间",prop:"updateTime",align:"center"},{label:"操作",prop:"region",align:"center",render:function(t,i){var a=i.props.row;return t("div",{class:"table-action"},[t("span",{on:{click:function(){return e.update(a)}}},["编 辑"]),t("el-divider",{attrs:{direction:"vertical"}}),t("span",{on:{click:function(){return e.delete(a.id)}}},["删 除"])])}}],loading:!1,isAdd:!1,editVisible:!1,imgVisible:!1,dialogImageUrl:"",form:{name:"",display:""},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:4,max:15,message:"长度在 4 到 15 个字符",trigger:"blur"}]},fileList:[]}},computed:{url:function(){return this.add?"add":"update"}},created:function(){this.fetchData()},methods:{controlHideUpload:function(e,t){t.length>0?this.hideUpload():this.hideUpload("")},onError:function(){this.$message1000("文件上传出错：网络错误","error"),this.editVisible=!1},uploadOk:function(e){if(e.success)this.$message1000("文件上传成功","success"),this.close(),this.fetchData(),this.editVisible=!1;else{var t=e.msg;t="文件上传出错："+t,this.$message1000(t,"error"),this.fileList=[],this.editVisible=!1}},handlePreview:function(e){this.imgVisible=!0,this.dialogImageUrl=e.url},fetchData:function(){var e=this;this.loading=!0,o.getPartner().then(function(t){e.partnerData=t.list}).finally(function(t){e.loading=!1})},add:function(){this.hideUpload(""),this.isAdd=!0,this.editVisible=!0},hideUpload:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"none";this.$nextTick(function(){e.$refs.upload.$refs["upload-inner"].$el.style.display=t})},update:function(e){this.hideUpload(),this.isAdd=!1,this.form=Object(c["b"])(e),this.fileList=[{name:"food.jpg",url:"https://img-bcy-qn.pstatp.com/user/213091/item/c0r3z/45a1ac2a95a54db08c6a5f1e5c31aa6b.jpg?imageMogr2/auto-orient/strip|watermark/2/text/wqnms73mnIgK5Y2K5qyh5YWDIC0gQUNH54ix5aW96ICF56S-5Yy6/fontsize/1824/fill/I2NjY2NjYw==/dx/59/dy/44/font/5b6u6L2v6ZuF6buR"}],this.editVisible=!0},delete:function(e){var t=this;this.$confirm("此操作将删除该合作伙伴, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.deletePartner(e).then(function(e){t.$message1000("删除成功","success"),t.fetchData()})})},close:function(){this.fileList=[],this.form={name:"",display:""}},submitForm:function(){var e=this;this.fileList.length<1?this.$message1000("请上传图片","warning"):this.$refs.form.validate(function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(i){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!i){t.next=4;break}e.$refs.upload.submit(),t.next=6;break;case 4:return console.log("error submit!!"),t.abrupt("return",!1);case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())},resetForm:function(){this.$refs.form.resetFields()}}},u=d,f=i("2877"),p=Object(f["a"])(u,a,n,!1,null,"137f2f56",null);t["default"]=p.exports},a8da:function(e,t,i){},b4e4:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"add-button",on:{click:e.add}},[i("i",{staticClass:"el-icon-plus"})])},n=[],r={name:"AddButton",methods:{add:function(){this.$emit("add")}}},s=r,l=(i("65ed"),i("2877")),o=Object(l["a"])(s,a,n,!1,null,"f1447e70",null);t["a"]=o.exports}}]);